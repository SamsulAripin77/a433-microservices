- kode docker file
FROM node:18-alpine as builder
WORKDIR /app
RUN npm ci
COPY ./*.js ./
COPY package* ./
EXPOSE 3000
CMD ["node", "index.js"]


kode docker compose rabbitmq
version: '3.2'
services:
  submission_rabbitmq:
    image: rabbitmq:3.11-management
    container_name: 'submission_rabbitmq_container'
    ports:
      - 5673:5672
      - 15673:15672
    volumes:
      - ~/.docker-conf/rabbitmq/data/:/var/lib/rabbitmq/
      - ~/.docker-conf/rabbitmq/log/:/var/log/rabbitmq
networks:
  rabbitmq_network:
    driver: bridge

kode docker compose rabbitmq shipping service
version: '3.2'
services:
  shipping-service:
    image: ghcr.io/codewithrey/a433-microservices/reynaldi491-docker/shipping-service:latest
    ports:
      - '3001:3001'
    environment:
      NODE_ENV: production
      AMQP_URL: amqp://guest:guest@rabbitmq:5672 # kombinasikan klo error pake ini AMQP_URL=amqp://rabbitmq:5672
    command: sh -c '/bin/wait-for-it.sh rabbitmq:5672 --timeout=30 -- node index.js'
    depends_on:
      - rabbitmq
    networks:
      - rabbitmq_default
networks:
  rabbitmq_default:
    external: true



kode gabungang rabbitmq
version: "3"

services:

  # Layanan order-service

  order-service:

    image: ghcr.io/shafaio/order-service:latest

    ports:

      - "4000:3000" # Meneruskan port 4000 dari host ke port 3000 di dalam container

    depends_on:

      - rabbitmq # Menunggu hingga layanan rabbitmq selesai berjalan sebelum memulai order-service

  # Layanan shipping-service

  shipping-service:

    image: ghcr.io/shafaio/shipping-service:latest

    ports:

      - "3000:3000" # Meneruskan port 3001 dari host ke port 3001 di dalam container

    depends_on:

      - rabbitmq # Menunggu hingga layanan rabbitmq selesai berjalan sebelum memulai shipping-service

  # Layanan rabbitmq

  rabbitmq:

    image: rabbitmq:3.11-management

    ports:

      - "5672:5672" # Meneruskan port 5672 dari host ke port 5672 di dalam container untuk protokol AMQP

      - "15672:15672" # Meneruskan port 15672 dari host ke port 15672 di dalam container untuk antarmuka manajemen RabbitMQ

    environment:

      - RABBITMQ_DEFAULT_USER=admin # Menetapkan username untuk RabbitMQ

      - RABBITMQ_DEFAULT_PASS=admin # Menetapkan password untuk RabbitMQ


atau bisa pakai kode docker compose ini 
version: '2.1'

services:

  order-service:

  image: andryylo/order-service

  container_name: order-service

  ports:

    - 3000:3000

  depends_on:

    rabbitmq:

      condition: service_healthy

  links:

    - rabbitmq

  networks:

    - rabbitmq_network

  shipping-service:

  image: andryylo/shipping-service

  container_name: shipping-service

  ports:

    - 3001:3001

  depends_on:

    rabbitmq:

      condition: service_healthy

  links:

    - rabbitmq

  networks:

    - rabbitmq_network

  rabbitmq:

    image: rabbitmq:3.11-management 

    container_name: rabbitmq

    ports:

      - 5673:5672

      - 15673:15672

    volumes:

        - rabbitmq_data:/var/lib/rabbitmq/

        - rabbitmq_log/:/var/log/rabbitmq

    healthcheck:

      test: "exit 0"

    networks:

      - rabbitmq_network    

  volumes:

    rabbitmq_data:

    rabbitmq_log:  

networks:

  rabbitmq_network:

    driver: bridge